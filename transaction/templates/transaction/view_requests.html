{% extends "base.html" %}

{% block title %}View Requests {% endblock %}

{% block content %}
<div class="list group">
    <h1 class="mb-4 text-center">Purchase Requests</h1>
    {% if requests %}
        <div class="list-group">
            {& for r in requests &}
                <div class="list-group-item shadow-sm mb-3">
                    <h5 class="mb-1">Request #{{r.id}} </h5>
                    <p class="mb-1">Product ID : <b>{{r.product_id}}</b></p>
                    <p class="mb-1">Buyer ID : <b>{{r.buyer_id}}</b></p>
                    <p>Status:
                        {% if r.status == "pending" %}
                            <span class="badge bg-warning text-dark">Pending</span>
                        {% elif r.status == "accepted" %}
                            <span class="badge bg-success">Accepted</span>
                        {% elif r.status == "rejected" %}
                            <span class="badge bg-danger">Rejected</span>
                        {% else %}
                            <span class="badge bg-secondary">{{r.status}}</span>
                        {% endif %}
                    </p>

                    {& if r.status == "pending" &}
                        <form action="{{url_for('transaction.accept_transaction',transaction_id=r.id)}}" method="POST" style="display:inline;">
                            <button type="submit" class="btn btn-sm btn-success">Accept</button>
                        </form>
                        <form action="{{url_for('transaction.reject_transaction',transaction_id=r.id)}}" method="POST" style="display:inline;">
                            <button type="submit" class="btn btn-sm btn-danger">Reject</button>
                        </form>
                    {% endif %}
                </div>
            {% endfor %}
        </div>
    {% else %}
        <p class="text-muted text-center">No purchase requests yet.</p>
    {% endif %}
</div>
{% endblock %}
