{% extends "home.html" %}

{% block content %}
<div class="text-center my-5">
  {% if not session.get('user_id') %}
    <h1 class="display-4">Welcome to Second Loop</h1>
    <p class="lead">Buy and sell pre-loved items with ease.</p>
    <a href="{{ url_for('login') }}" class="btn btn-primary btn-lg mt-3">Login to Get Started</a>
  {% else %}
    <h1 class="display-5">Welcome back, {{ session.get('user_name', '') }}!</h1>
    <p class="lead">Check out the latest deals below ðŸ‘‡</p>
  {% endif %}
</div>

<hr>

<h3 class="mt-5">Latest Products</h3>
<div class="row mt-3">
  {% if products %}
    {% for product in products %}
    <div class="col-md-4 mb-4">
      <div class="card h-100">
        <img src="{{ url_for('static', filename='uploads/' + product.image) }}" 
             class="card-img-top" alt="{{ product.name }}">
        <div class="card-body d-flex flex-column">
          <h5 class="card-title">{{ product.name }}</h5>
          <p class="card-text">
            {{ product.description[:100] }}
            {% if product.description|length > 100 %}...{% endif %}
          </p>
          <p><strong>Price:</strong> MYR {{ "%.2f"|format(product.price) }}</p>
          <a href="{{ url_for('product', product_id=product.id) }}" class="btn btn-info btn-sm mt-auto">View Details</a>
        </div>
      </div>
    </div>
    {% endfor %}
  {% else %}
    <p class="text-muted">No products available yet.</p>
  {% endif %}
</div>
{% endblock %}