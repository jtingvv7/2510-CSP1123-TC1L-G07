<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Reset Password</title>
  <link rel="stylesheet" href="{{ url_for('usersystem.static', filename='usersystemstyle.css') }}">
</head>
<body>
  <div class="container">

    <div class="reset-card">
      {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
          {% for category, message in messages %}
            <div class="flash-message {{ category }}">
              {{ message }}
            </div>
          {% endfor %}
        {% endif %}
      {% endwith %}

      <h2>Reset Password</h2>

      <form method="POST">
        <label>Email:</label>
        <input type="email" name="email" required value="{{ request.form.email if request.form.email }}">

        {% if email_verified %}
          <label>New Password:</label>
          <input type="password" name="password">

          <label>Confirm Password:</label>
          <input type="password" name="confirm_password">
        {% endif %}

        <button type="submit">
          {% if email_verified %}
            Reset Password
          {% else %}
            Verify Email
          {% endif %}
        </button>
      </form>
    </div>

    <div style="text-align: center; margin-top: 15px;">
      <a href="{{ url_for('usersystem.login') }}">Back to Login</a>
    </div>

  </div>

  <!-- Auto-hide flash messages after 5 seconds -->
  <script>
    setTimeout(() => {
      const flashes = document.querySelectorAll('.flash-message');
      flashes.forEach(flash => flash.remove());
    }, 5000);
  </script>
</body>
</html>